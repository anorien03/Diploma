<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:oxy="http://oxyplot.org/avalonia"
        xmlns:vm="using:ContainerPackingApp.ViewModels"
        xmlns:converters="using:Avalonia.Data.Converters"
        xmlns:controls="using:ContainerPackingApp.Controls"
        Width="1500"
        Height="800"
        mc:Ignorable="d" 
        d:DesignWidth="800" 
        d:DesignHeight="600"
        x:Class="ContainerPackingApp.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="Упаковка контейнеров в трюм с использованием генетического алгоритма">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>



    <ScrollViewer Background="#1c1c1c">
        <StackPanel Margin="40, 20" Spacing="10">
            <TextBlock Text="Параметры генетического алгоритма" FontSize="20" FontWeight="Bold"/>

            <Grid ColumnDefinitions="200,*, *, 260, *" RowDefinitions="Auto,Auto,Auto,Auto,Auto, Auto" RowSpacing="6">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Размер популяции:" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding PopulationSizeInput}"/>
                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PopulationSizeError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Количество поколений:" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding GenerationsCountInput}"/>
                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding GenerationsCountError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="4" Grid.Column="0" Text="Процент мутации (%):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding MutationRateInput}"/>
                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding MutationRateError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="0" Grid.Column="3" Text="Количество особей в турнире:" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="0" Grid.Column="4" Text="{Binding TournamentSizeInput}"/>
                <TextBlock Grid.Row="1" Grid.Column="4" Text="{Binding TournamentSizeError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="2" Grid.Column="3" Text="Процент элитизма (%):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="2" Grid.Column="4" Text="{Binding ElitismInput}"/>
                <TextBlock Grid.Row="3" Grid.Column="4" Text="{Binding ElitismError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
            </Grid>
            
            <Separator Margin="0,10"/>
            
            <TextBlock Text="Параметры трюма" FontSize="20" FontWeight="Bold"/>
            
            <Grid ColumnDefinitions="200,*, *, 260, *" RowDefinitions="Auto,Auto,Auto,Auto, Auto" RowSpacing="6">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Длина (дм):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ShipHoldLengthInput}"/>
                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding ShipHoldLengthError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="2" Grid.Column="0" Text="Ширина (дм):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding ShipHoldWidthInput}"/>
                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding ShipHoldWidthError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="0" Grid.Column="3" Text="Высота (дм):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="0" Grid.Column="4" Text="{Binding ShipHoldHeightInput}"/>
                <TextBlock Grid.Row="1" Grid.Column="4" Text="{Binding ShipHoldHeightError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
                
                <TextBlock Grid.Row="2" Grid.Column="3" Text="Грузоподъемность (т):" VerticalAlignment="Center" FontSize="16"/>
                <TextBox Grid.Row="2" Grid.Column="4" Text="{Binding ShipHoldMaxWeightInput}"/>
                <TextBlock Grid.Row="3" Grid.Column="4" Text="{Binding ShipHoldMaxWeightError}" 
                           Foreground="Red" FontSize="13" Margin="0,-5,0,0"/>
            </Grid>


            <!-- После параметров трюма добавьте: -->
<Separator Margin="0,10"/>

<TextBlock Text="Контейнеры" FontSize="20" FontWeight="Bold"/>

<StackPanel Orientation="Horizontal" Spacing="10">
    <Button Content="Загрузить из CSV" Command="{Binding LoadContainersFromCsv}"/>
    <Button Content="Добавить контейнер" Command="{Binding AddContainer}"/>
    <Button Content="Удалить все" Command="{Binding RemoveAllContainers}"/>
    <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding ContainersCount}" VerticalAlignment="Center"/>
</StackPanel>

<ItemsControl ItemsSource="{Binding Containers}" Margin="0,10">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="10" Margin="0,5">
                <Grid ColumnDefinitions="50,100,*,*,*,*,*,*,*,*,Auto" RowDefinitions="Auto,Auto" RowSpacing="5">
                    <TextBlock Grid.Row="0" Grid.Column="0" Text="ID:" VerticalAlignment="Center"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Id}" VerticalAlignment="Center"/>
                    
                    <TextBlock Grid.Row="0" Grid.Column="2" Text="Длина:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Row="0" Grid.Column="3" Text="{Binding LengthInput}" Width="120"/>
                    <TextBlock Grid.Row="1" Grid.Column="3" Grid.ColumnSpan="2" Text="{Binding LengthError}" 
                           Foreground="Red" FontSize="12" Margin="0,-5,0,0"/>
                    
                    <TextBlock Grid.Row="0" Grid.Column="4" Text="Ширина:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Row="0" Grid.Column="5" Text="{Binding WidthInput}" Width="120"/>
                    <TextBlock Grid.Row="1" Grid.Column="5" Grid.ColumnSpan="2" Text="{Binding WidthError}" 
                           Foreground="Red" FontSize="12" Margin="0,-5,0,0"/>
                    
                    <TextBlock Grid.Row="0" Grid.Column="6" Text="Высота:" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="0" Grid.Column="7" Text="{Binding HeightInput}" Width="120"/>
                    <TextBlock Grid.Row="1" Grid.Column="7" Grid.ColumnSpan="2" Text="{Binding HeightError}" 
                           Foreground="Red" FontSize="12" Margin="0,-5,0,0"/>
                    
                    <TextBlock Grid.Row="0" Grid.Column="8" Text="Масса:" VerticalAlignment="Center" Margin="10,0,0,0"/>
                    <TextBox Grid.Row="0" Grid.Column="9" Text="{Binding WeightInput}" Width="120"/>
                    <TextBlock Grid.Row="1" Grid.Column="9" Grid.ColumnSpan="2" Text="{Binding WeightError}" 
                           Foreground="Red" FontSize="12" Margin="0,-5,0,0"/>
                    
                    <Button Grid.Row="0" Grid.Column="10" Content="Удалить" 
                            Command="{Binding $parent[ItemsControl].DataContext.RemoveContainer}"
                            CommandParameter="{Binding}"/>
                </Grid>

            </Border>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl>

            
            <!-- Остальная часть XAML остается без изменений -->
            
            <Separator Margin="0,10"/>
            <StackPanel Orientation="Horizontal" Spacing="10">
                <Button Content="Запустить алгоритм" Command="{Binding RunAlgorithm}" IsEnabled="{Binding !IsRunning}"/>
                <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding ErrorText}" VerticalAlignment="Center"/>
            </StackPanel>
            
            <TextBox Text="{Binding ResultText}" 
         IsReadOnly="True" 
         AcceptsReturn="True"
         TextWrapping="Wrap"
         Margin="0,10"
         Padding="10"
         BorderBrush="#e0e0e0"
         BorderThickness="1"
         MaxHeight="150"/>



<StackPanel Margin="0,10" IsVisible="{Binding HasResults}">
    <TextBlock Text="Результаты упаковки:" 
               FontWeight="Bold"
               Margin="0,0,0,5"/>
    
    <Border BorderBrush="#e0e0e0" 
            BorderThickness="1"
            Padding="10">
        <ItemsControl ItemsSource="{Binding PackedContainers}">
            <ItemsControl.Styles>
                <Style Selector="ItemsControl">
                    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
                </Style>
            </ItemsControl.Styles>
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Grid Margin="0,0,0,5" 
                          ColumnDefinitions="Auto,5,Auto,5,Auto,5,Auto,5,Auto,5,Auto">
                        <TextBlock Text="ID:" Grid.Column="0" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Id}" Grid.Column="2"/>
                        
                        <TextBlock Text="Начало:" Grid.Column="4" FontWeight="Bold"/>
                        <TextBlock Text="{Binding StartCoordinates}" Grid.Column="6"/>
                        
                        <TextBlock Text="Конец:" Grid.Column="8" FontWeight="Bold"/>
                        <TextBlock Text="{Binding EndCoordinates}" Grid.Column="10"/>
                    </Grid>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Border>
</StackPanel>

<!-- График (видим только после расчета) -->
<controls:GraphControl DataPoints="{Binding FitnessData}" 
                      Height="300"
                      Margin="0,10"
                      IsVisible="{Binding HasResults}"/>

        </StackPanel>
    </ScrollViewer>
</Window>